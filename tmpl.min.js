!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.tmpl=e():t.tmpl=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var n=r(1),a=r(10),i=r(18);t.exports={parse:n.parse,stamping:function(t){return a.stamping(t)},traverse:function(t){return{handle:function(e,r){n.traverse(t).when(e,r)}}},getHTML:i}},function(t,e,r){var n=r(2),a=r(3),i=r(4),o=r(5);t.exports={_modules:{include:r(8),partial:r(9)},_regex:{forVariables:/\{\{ ?(.*?) ?\}\}/g},safeReplaceCaseReg:/\r|\n|\t|\/\*[\s\S]*?\*\//g,safeReplaceCasePlace:"",_includeStack:{},parse:function(t,e){var r=new n.DefaultHandler(e||this.defaultHandler,{ignoreWhitespace:!0}),a=new n.Parser(r);return a.parseComplete(t),r.dom},_traverseTagAttributes:function(t,e){var r=a.clone(t);return a.eachObject(r,function(t){return this._traverseText({data:t},e)}.bind(this))},_moduleMatcher:function(t){return void 0!==this._modules[t.name]?this._modules[t.name].module:!1},_replaceAllUncertainStuff:function(t){return t.trim().replace(this.safeReplaceSingleQuotesReg,this.safeReplaceSingleQuotesPlace).replace(this.safeReplaceCaseReg,this.safeReplaceCasePlace)},_searchForVars:function(t){return a.mapForLoop(t,function(t){return t.split(this._regex.forVariables).join("")}.bind(this))},_replaceAndCreateStatements:function(t,e){return a.mapForLoop(t,function(t){return ssCheck=i.checkStatementForInners(t,e),ssCheck.isVar?this._createDataVar(t,ssCheck.value):this._createDataText(t)}.bind(this))},_replaceMatch:function(t){var e,r=/\{\{ ?(.*?) ?\}\}/g,n=this._replaceAllUncertainStuff(t.data),a=n.match(r),i=t;return a&&(e=this._searchForVars(a)),i.data=n.split(r),e?i.data=this._replaceAndCreateStatements(i.data,e):i.data=this._createDataText(i.data[0]),i},_lookForStatements:function(t){return this._replaceMatch(t)},_whatMethodShouldYouUse:function(t){return this._isTag(t.type)?this._modules[t.name]?this._traverseModule:this._traverseTag:this._isText(t.type)?this._traverseText:void 0},actionOnMainArray:function(t,e){if(void 0!==e)if(e.length>0)for(var r=0;r<e.length;r++)t.concat(this.actionOnMainArray(t,e[r]));else t.push(e);return e=null,t},_collect:function(t,e){var r=t.call(this,e);return this.isTagInclude(e.name)?void(this._includeStack[e.attribs.name]=r):r},traversingAST:function(t){for(var e,r,n=[],a=0;a<t.length;a++)e=this._whatMethodShouldYouUse(t[a]),e&&(r=this._collect(e,t[a]),void 0!==r&&n.push(r));return o.every(n)},traverse:function(t,e){return this.traversingAST(t).when(function(t){return this.actionOnMainArray([],t)}.bind(this),function(t){throw new Error(t)})},_loadModuleFunction:function(t,e){var r=t(e),n=r.call(this);return n?n:void 0},_generatorFunctionForTags:function(t,e){return t.children=this.actionOnMainArray([],e),t},traverseTagWithChildren:function(t,e){return this.traversingAST(t.children,e).when(function(e){return this._generatorFunctionForTags(t,e)}.bind(this),function(t){throw new Error(t)})},_traverseTag:function(t){var e,r=this._traverseTagAttributes(t.attribs),n=this._createTag(t.name,t.data,t.raw,r,t.children);return n.children&&n.children.length>0?this.traverseTagWithChildren(n):(e=o.make(),e.keep(this._generatorFunctionForTags(n)),e.promise)},_traverseModule:function(t){var e=this._moduleMatcher(t);return this._loadModuleFunction(e,t)},_traverseText:function(t){var t=a.clone(t),e=o.make();return t.hasOwnProperty("type")?(t.raw=this._replaceAllUncertainStuff(t.raw),e.keep(this._lookForStatements(t)),e.promise):this._lookForStatements(t)},_isTag:function(t){return"tag"===t},_isText:function(t){return"text"===t},isTagInclude:function(t){return"include"===t},_createDataVar:function(t,e){return{type:"var",name:t,value:e}},_createDataText:function(t){return{type:"text",value:t}},_createTag:function(t,e,r,n,a){return{name:t,data:e,raw:r,attribs:n,children:a,type:"tag"}},defaultHandler:function(t,e){if(t)throw new Error(t)}}},function(t,e,r){(function(r,n){!function(){function a(){return"object"==typeof e&&"object"==typeof t&&"string"==typeof r&&"string"==typeof n}function i(t,e){this._options=e?e:{},void 0==this._options.includeLocation&&(this._options.includeLocation=!1),this.validateHandler(t),this._handler=t,this.reset()}function o(t){o.super_.call(this,t,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1})}function s(t,e){this.reset(),this._options=e?e:{},void 0==this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1),void 0==this._options.verbose&&(this._options.verbose=!0),void 0==this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0),"function"==typeof t&&(this._callback=t)}function c(t,e){var r=function(){};r.prototype=e.prototype,t.super_=e,t.prototype=new r,t.prototype.constructor=t}if(!a()){if(this.Tautologistics){if(this.Tautologistics.NodeHtmlParser)return}else this.Tautologistics={};this.Tautologistics.NodeHtmlParser={},e=this.Tautologistics.NodeHtmlParser}var l={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag"};i._reTrim=/(^\s+|\s+$)/g,i._reTrimComment=/(^\!--|--$)/g,i._reWhitespace=/\s/g,i._reTagName=/^\s*(\/?)\s*([^\s\/]+)/,i._reAttrib=/([^=<>\"\'\s]+)\s*=\s*"([^"]*)"|([^=<>\"\'\s]+)\s*=\s*'([^']*)'|([^=<>\"\'\s]+)\s*=\s*([^'"\s]+)|([^=<>\"\'\s\/]+)/g,i._reTags=/[\<\>]/g,i.prototype.parseComplete=function(t){this.reset(),this.parseChunk(t),this.done()},i.prototype.parseChunk=function(t){this._done&&this.handleError(new Error("Attempted to parse chunk after parsing already done")),this._buffer+=t,this.parseTags()},i.prototype.done=function(){if(!this._done){if(this._done=!0,this._buffer.length){var t=this._buffer;this._buffer="";var e={raw:t,data:this._parseState==l.Text?t:t.replace(i._reTrim,""),type:this._parseState};(this._parseState==l.Tag||this._parseState==l.Script||this._parseState==l.Style)&&(e.name=this.parseTagName(e.data)),this.parseAttribs(e),this._elements.push(e)}this.writeHandler(),this._handler.done()}},i.prototype.reset=function(){this._buffer="",this._done=!1,this._elements=[],this._elementsCurrent=0,this._current=0,this._next=0,this._location={row:0,col:0,charOffset:0,inBuffer:0},this._parseState=l.Text,this._prevTagSep="",this._tagStack=[],this._handler.reset()},i.prototype._options=null,i.prototype._handler=null,i.prototype._buffer=null,i.prototype._done=!1,i.prototype._elements=null,i.prototype._elementsCurrent=0,i.prototype._current=0,i.prototype._next=0,i.prototype._location=null,i.prototype._parseState=l.Text,i.prototype._prevTagSep="",i.prototype._tagStack=null,i.prototype.parseTagAttribs=function(t){for(var e=t.length,r=0;e>r;){var n=t[r++];(n.type==l.Tag||n.type==l.Script||n.type==l.style)&&this.parseAttribs(n)}return t},i.prototype.parseAttribs=function(t){if(t.type==l.Script||t.type==l.Style||t.type==l.Tag){var e=t.data.split(i._reWhitespace,1)[0],r=t.data.substring(e.length);if(!(r.length<1)){var n;for(i._reAttrib.lastIndex=0;n=i._reAttrib.exec(r);)void 0==t.attribs&&(t.attribs={}),"string"==typeof n[1]&&n[1].length?t.attribs[n[1]]=n[2]:"string"==typeof n[3]&&n[3].length?t.attribs[n[3].toString()]=n[4].toString():"string"==typeof n[5]&&n[5].length?t.attribs[n[5]]=n[6]:"string"==typeof n[7]&&n[7].length&&(t.attribs[n[7]]=n[7])}}},i.prototype.parseTagName=function(t){if(null==t||""==t)return"";var e=i._reTagName.exec(t);return e?(e[1]?"/":"")+e[2]:""},i.prototype.parseTags=function(){for(var t=this._buffer.length-1;i._reTags.test(this._buffer);){this._next=i._reTags.lastIndex-1;var e=this._buffer.charAt(this._next),r=this._buffer.substring(this._current,this._next),n={raw:r,data:this._parseState==l.Text?r:r.replace(i._reTrim,""),type:this._parseState},a=this.parseTagName(n.data);if(this._tagStack.length)if(this._tagStack[this._tagStack.length-1]==l.Script){if("/script"==a.toLowerCase())this._tagStack.pop();else if(0!=n.raw.indexOf("!--")&&(n.type=l.Text,this._elements.length&&this._elements[this._elements.length-1].type==l.Text)){var o=this._elements[this._elements.length-1];o.raw=o.data=o.raw+this._prevTagSep+n.raw,n.raw=n.data=""}}else if(this._tagStack[this._tagStack.length-1]==l.Style){if("/style"==a.toLowerCase())this._tagStack.pop();else if(0!=n.raw.indexOf("!--"))if(n.type=l.Text,this._elements.length&&this._elements[this._elements.length-1].type==l.Text){var o=this._elements[this._elements.length-1];""!=n.raw?(o.raw=o.data=o.raw+this._prevTagSep+n.raw,n.raw=n.data=""):o.raw=o.data=o.raw+this._prevTagSep}else""!=n.raw&&(n.raw=n.data=n.raw)}else if(this._tagStack[this._tagStack.length-1]==l.Comment){var s=n.raw.length;if("-"==n.raw.charAt(s-2)&&"-"==n.raw.charAt(s-1)&&">"==e)if(this._tagStack.pop(),this._elements.length&&this._elements[this._elements.length-1].type==l.Comment){var o=this._elements[this._elements.length-1];o.raw=o.data=(o.raw+n.raw).replace(i._reTrimComment,""),n.raw=n.data="",n.type=l.Text}else n.type=l.Comment;else if(n.type=l.Comment,this._elements.length&&this._elements[this._elements.length-1].type==l.Comment){var o=this._elements[this._elements.length-1];o.raw=o.data=o.raw+n.raw+e,n.raw=n.data="",n.type=l.Text}else n.raw=n.data=n.raw+e}if(n.type==l.Tag){n.name=a;var c=a.toLowerCase();if(0==n.raw.indexOf("!--")){n.type=l.Comment,delete n.name;var s=n.raw.length;"-"==n.raw.charAt(s-1)&&"-"==n.raw.charAt(s-2)&&">"==e?n.raw=n.data=n.raw.replace(i._reTrimComment,""):(n.raw+=e,this._tagStack.push(l.Comment))}else 0==n.raw.indexOf("!")||0==n.raw.indexOf("?")?n.type=l.Directive:"script"==c?(n.type=l.Script,"/"!=n.data.charAt(n.data.length-1)&&this._tagStack.push(l.Script)):"/script"==c?n.type=l.Script:"style"==c?(n.type=l.Style,"/"!=n.data.charAt(n.data.length-1)&&this._tagStack.push(l.Style)):"/style"==c&&(n.type=l.Style);n.name&&"/"==n.name.charAt(0)&&(n.data=n.name)}(""!=n.raw||n.type!=l.Text)&&(this._options.includeLocation&&!n.location&&(n.location=this.getLocation(n.type==l.Tag)),this.parseAttribs(n),this._elements.push(n),n.type!=l.Text&&n.type!=l.Comment&&n.type!=l.Directive&&"/"==n.data.charAt(n.data.length-1)&&this._elements.push({raw:"/"+n.name,data:"/"+n.name,name:"/"+n.name,type:n.type})),this._parseState="<"==e?l.Tag:l.Text,this._current=this._next+1,this._prevTagSep=e}this._options.includeLocation&&(this.getLocation(),this._location.row+=this._location.inBuffer,this._location.inBuffer=0,this._location.charOffset=0),this._buffer=this._current<=t?this._buffer.substring(this._current):"",this._current=0,this.writeHandler()},i.prototype.getLocation=function(t){for(var e,r=this._location,n=this._current-(t?1:0),a=t&&0==r.charOffset&&0==this._current;r.charOffset<n;r.charOffset++)e=this._buffer.charAt(r.charOffset),"\n"==e?(r.inBuffer++,r.col=0):"\r"!=e&&r.col++;return{line:r.row+r.inBuffer+1,col:r.col+(a?0:1)}},i.prototype.validateHandler=function(t){if("object"!=typeof t)throw new Error("Handler is not an object");if("function"!=typeof t.reset)throw new Error("Handler method 'reset' is invalid");if("function"!=typeof t.done)throw new Error("Handler method 'done' is invalid");if("function"!=typeof t.writeTag)throw new Error("Handler method 'writeTag' is invalid");if("function"!=typeof t.writeText)throw new Error("Handler method 'writeText' is invalid");if("function"!=typeof t.writeComment)throw new Error("Handler method 'writeComment' is invalid");if("function"!=typeof t.writeDirective)throw new Error("Handler method 'writeDirective' is invalid")},i.prototype.writeHandler=function(t){if(t=!!t,!this._tagStack.length||t)for(;this._elements.length;){var e=this._elements.shift();switch(e.type){case l.Comment:this._handler.writeComment(e);break;case l.Directive:this._handler.writeDirective(e);break;case l.Text:this._handler.writeText(e);break;default:this._handler.writeTag(e)}}},i.prototype.handleError=function(t){if("function"!=typeof this._handler.error)throw t;this._handler.error(t)},c(o,s),o.prototype.done=function(){var t,e={},r=u.getElementsByTagName(function(t){return"rss"==t||"feed"==t},this.dom,!1);if(r.length&&(t=r[0]),t){if("rss"==t.name){e.type="rss",t=t.children[0],e.id="";try{e.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(n){}try{e.link=u.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(n){}try{e.description=u.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(n){}try{e.updated=new Date(u.getElementsByTagName("lastBuildDate",t.children,!1)[0].children[0].data)}catch(n){}try{e.author=u.getElementsByTagName("managingEditor",t.children,!1)[0].children[0].data}catch(n){}e.items=[],u.getElementsByTagName("item",t.children).forEach(function(t,r,n){var a={};try{a.id=u.getElementsByTagName("guid",t.children,!1)[0].children[0].data}catch(i){}try{a.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(i){}try{a.link=u.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(i){}try{a.description=u.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(i){}try{a.pubDate=new Date(u.getElementsByTagName("pubDate",t.children,!1)[0].children[0].data)}catch(i){}e.items.push(a)})}else{e.type="atom";try{e.id=u.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(n){}try{e.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(n){}try{e.link=u.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(n){}try{e.description=u.getElementsByTagName("subtitle",t.children,!1)[0].children[0].data}catch(n){}try{e.updated=new Date(u.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(n){}try{e.author=u.getElementsByTagName("email",t.children,!0)[0].children[0].data}catch(n){}e.items=[],u.getElementsByTagName("entry",t.children).forEach(function(t,r,n){var a={};try{a.id=u.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(i){}try{a.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(i){}try{a.link=u.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(i){}try{a.description=u.getElementsByTagName("summary",t.children,!1)[0].children[0].data}catch(i){}try{a.pubDate=new Date(u.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(i){}e.items.push(a)})}this.dom=e}o.super_.prototype.done.call(this)},s._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1},s.reWhitespace=/^\s*$/,s.prototype.dom=null,s.prototype.reset=function(){this.dom=[],this._done=!1,this._tagStack=[],this._tagStack.last=function(){return this.length?this[this.length-1]:null}},s.prototype.done=function(){this._done=!0,this.handleCallback(null)},s.prototype.writeTag=function(t){this.handleElement(t)},s.prototype.writeText=function(t){this._options.ignoreWhitespace&&s.reWhitespace.test(t.data)||this.handleElement(t)},s.prototype.writeComment=function(t){this.handleElement(t)},s.prototype.writeDirective=function(t){this.handleElement(t)},s.prototype.error=function(t){this.handleCallback(t)},s.prototype._options=null,s.prototype._callback=null,s.prototype._done=!1,s.prototype._tagStack=null,s.prototype.handleCallback=function(t){if("function"==typeof this._callback)this._callback(t,this.dom);else if(t)throw t},s.prototype.isEmptyTag=function(t){var e=t.name.toLowerCase();return"/"==e.charAt(0)&&(e=e.substring(1)),this._options.enforceEmptyTags&&!!s._emptyTags[e]},s.prototype.handleElement=function(t){if(this._done&&this.handleCallback(new Error("Writing to the handler after done() called is not allowed without a reset()")),this._options.verbose||(delete t.raw,("tag"==t.type||"script"==t.type||"style"==t.type)&&delete t.data),this._tagStack.last())if(t.type!=l.Text&&t.type!=l.Comment&&t.type!=l.Directive)if("/"==t.name.charAt(0)){var e=t.name.substring(1);if(!this.isEmptyTag(t)){for(var r=this._tagStack.length-1;r>-1&&this._tagStack[r--].name!=e;);if(r>-1||this._tagStack[0].name==e)for(;r<this._tagStack.length-1;)this._tagStack.pop()}}else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(t),this.isEmptyTag(t)||this._tagStack.push(t);else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(t);else t.type!=l.Text&&t.type!=l.Comment&&t.type!=l.Directive?"/"!=t.name.charAt(0)&&(this.dom.push(t),this.isEmptyTag(t)||this._tagStack.push(t)):this.dom.push(t)};var u={testElement:function(t,e){if(!e)return!1;for(var r in t)if("tag_name"==r){if("tag"!=e.type&&"script"!=e.type&&"style"!=e.type)return!1;if(!t.tag_name(e.name))return!1}else if("tag_type"==r){if(!t.tag_type(e.type))return!1}else if("tag_contains"==r){if("text"!=e.type&&"comment"!=e.type&&"directive"!=e.type)return!1;if(!t.tag_contains(e.data))return!1}else if(!e.attribs||!t[r](e.attribs[r]))return!1;return!0},getElements:function(t,e,r,n){function a(t){return function(e){return e==t}}if(r=void 0===r||null===r||!!r,n=isNaN(parseInt(n))?-1:parseInt(n),!e)return[];var i,o=[];for(var s in t)"function"!=typeof t[s]&&(t[s]=a(t[s]));if(u.testElement(t,e)&&o.push(e),n>=0&&o.length>=n)return o;if(r&&e.children)i=e.children;else{if(!(e instanceof Array))return o;i=e}for(var c=0;c<i.length&&(o=o.concat(u.getElements(t,i[c],r,n)),!(n>=0&&o.length>=n));c++);return o},getElementById:function(t,e,r){var n=u.getElements({id:t},e,r,1);return n.length?n[0]:null},getElementsByTagName:function(t,e,r,n){return u.getElements({tag_name:t},e,r,n)},getElementsByTagType:function(t,e,r,n){return u.getElements({tag_type:t},e,r,n)}};e.Parser=i,e.DefaultHandler=s,e.RssHandler=o,e.ElementType=l,e.DomUtils=u}()}).call(e,"/index.js","/")},function(t,e){(function(e){t.exports={mapForLoop:function(t,e){for(var r=t.length,n=new Array(r),a=0;r>a;a++)n[a]=e(t[a],a,t);return n},eachObject:function(t,e){for(value in t)t.hasOwnProperty(value)&&(t[value]=e(t[value]));return t},inArray:function(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return!0;return!1},isNode:function(){return"[object process]"===Object.prototype.toString.call(e.process)},clone:function r(t){function e(t,e,r){var n,a,i={};for(n in e)a=e[n],n in t&&(t[n]===a||n in i&&i[n]===a)||(t[n]=r?r(a):a);return t}if(!t||"object"!=typeof t||"[object Function]"===Object.prototype.toString.call(t))return t;if(t.nodeType&&"cloneNode"in t)return t.cloneNode(!0);if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);var n,a,i;if(t instanceof Array)for(n=[],a=0,i=t.length;i>a;++a)a in t&&n.push(r(t[a]));else n=t.constructor?new t.constructor:{};return e(n,t,r)}}}).call(e,function(){return this}())},function(t,e,r){var n=r(3);t.exports={checkStatementForInners:function(t,e){function r(t,e,r){return t?{isVar:t,name:r,value:e}:{isVar:t,value:e}}var a=".",i=(t.split(a),n.inArray(e,t));return i===!0?r(i,void 0,t):r(i,t)}}},function(t,e,r){(function(e){var r=function(){"use strict";function t(t,r){t.forEach(function(t){e(t,r)})}return"function"!=typeof e&&(e=function(t,e){return setTimeout(function(){t(e)},0)}),{make:function n(){function e(t,e,r){var n="keep"===t?o:i;n[n.length]="function"!=typeof e?r[t]:function(t){try{var n=e(t);n&&n.is_promise===!0?n.when(r.keep,r["break"]):r.keep(n)}catch(a){r["break"](a)}}}function r(e,r,n){if("pending"!==s)throw"overpromise";a=r,s=e,t(n,a),o.length=0,i.length=0}var a,i=[],o=[],s="pending";return{"break":function(t){r("broken",t,i)},keep:function(t){r("kept",t,o)},promise:{is_promise:!0,when:function(r,c){var l=n();switch(s){case"pending":e("keep",r,l),e("break",c,l);break;case"kept":e("keep",r,l),t(o,a);break;case"broken":e("break",c,l),t(i,a)}return l.promise}}}},every:function(t){var e=t.length,n=[],a=r.make();return e?t.forEach(function(t,r){t.when(function(t){n[r]=t,e-=1,0===e&&a.keep(n)},function(t){e=NaN,a["break"](t)})}):a["break"](t),a.promise},first:function(t){function e(){a-=1,0!==a||n||i["break"]()}var n=!1,a=t.length,i=r.make();return 0===a?i["break"](t):t.forEach(function(t){t.when(function(t){n||(n=!0,i.keep(t)),e()},e)}),i.promise},any:function(t){function e(){n-=1,0===n&&i.keep(a)}var n=t.length,a=[],i=r.make();return n?t.forEach(function(t,r){t.when(function(t){a[r]=t,e()},e)}):i.keep(a),i.promise},kept:function(t){var e=r.make();return e.keep(t),e.promise},broken:function(t){var e=r.make();return e["break"](t),e.promise}}}();t.exports=r}).call(e,r(6).setImmediate)},function(t,e,r){(function(t,n){function a(t,e){this._id=t,this._clearFn=e}var i=r(7).nextTick,o=Function.prototype.apply,s=Array.prototype.slice,c={},l=0;e.setTimeout=function(){return new a(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new a(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var r=l++,n=arguments.length<2?!1:s.call(arguments,1);return c[r]=!0,i(function(){c[r]&&(n?t.apply(null,n):t.call(null),e.clearImmediate(r))}),r},e.clearImmediate="function"==typeof n?n:function(t){delete c[t]}}).call(e,r(6).setImmediate,r(6).clearImmediate)},function(t,e){function r(){l=!1,o.length?c=o.concat(c):u=-1,c.length&&n()}function n(){if(!l){var t=setTimeout(r);l=!0;for(var e=c.length;e;){for(o=c,c=[];++u<e;)o[u].run();u=-1,e=c.length}o=null,l=!1,clearTimeout(t)}}function a(t,e){this.fun=t,this.array=e}function i(){}var o,s=t.exports={},c=[],l=!1,u=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new a(t,e)),1!==c.length||l||setTimeout(n,0)},a.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=i,s.addListener=i,s.once=i,s.off=i,s.removeListener=i,s.removeAllListeners=i,s.emit=i,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,r){var n,a=r(5),i=r(3);t.exports={module:function(o){function s(t){var e=new XMLHttpRequest;return e.open("GET",t),e.send(),e}function c(t){var e,r=a.make();try{e=requirejs("fs")}catch(n){throw new Error("There is no requirejs for node included")}return e.readFile("./"+t,function(t,e){t?r["break"](t):r.keep(this.parse(e))}.bind(this)),r.promise}function l(t){var e=a.make();return t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e.keep(this.parse(t.responseText))}.bind(this),e.promise}function u(t){return t}function h(){return m===!1?(f=s(d),l.call(this,f).when(u)):c.call(this,d).when(u)}var f,p=(o.attribs.name.trim(),o.attribs.template.trim()),d=p+".tmpl",m=i.isNode();return m===!1&&(n=function(){return{}}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))),function(){return h.call(this)}}}},function(t,e,r){var n=r(5);r(3);t.exports={module:function(t){function e(){var e=n.make();return this._includeStack[r].when(function(n){n?this.traversingAST(n).when(function(r){t.children=r,e.keep(t)},function(t){throw new Error(t)}):e["break"]('Include tag for "'+r+'" is not found!')}.bind(this),function(t){throw new Error(t)}),e.promise}var r=(t.attribs.data.trim(),t.attribs.template.trim());return function(){return e.call(this)}}}},function(t,e,r){r(3),r(11);t.exports={_modules:{"if":r(12),"for":r(16),partial:r(17)},fnDataName:"tm",mainVar:"ast",fnGenerateText:"function createText(data, raw) { return { data: data, raw: raw, type: 'text' } };",fnGenerateTag:"function createTag(name, data, raw, attribs, children) { return { name: name, data: data, raw: raw, attribs: attribs, children: children, type: 'tag' }; };",fnGen:function(t){return"function templateGenAST(tm) { var "+this.mainVar+"= []; "+this.fnGenerateText+" "+this.fnGenerateTag+" "+t+" return "+this.mainVar+"; }"},stamping:function(t){return this.fnGen(this.stampingAST(t))},createTagString:function(t,e,r,n,a){return this.mainVar+".push(createTag('"+t+"', '"+e+"', '"+r+"', "+n+", "+a+"));"},createTextString:function(t,e){return this.mainVar+".push(createText("+t+",'"+e+"'));"},createDataText:function(t){return"{type:'text', value:'"+t+"'}"},createDataVar:function(t,e){return"{type:'var', name:'"+t+"', value:'"+e+"'}"},whatTypeOfData:function(t){return"var"===t.type?this.createDataVar(t.name,t.value):this.createDataText(t.value)},createDataArray:function(t){for(var e="[",r=0;r<t.length;r++)e+=this.whatTypeOfData(t[r]),t.length-1!==r&&(e+=",");return e+="]"},createAttributeWithData:function(t,e){return t+":{data:"+e+"},"},createData:function(t){return void 0===t.length?this.whatTypeOfData(t):this.createDataArray(t)},createAttribute:function(t,e){return this.createAttributeWithData(t,this.createData(e))},traverseTagWithChildren:function(t){return traversingAST(t.children)},traverseTagAttributes:function(t){var e;if(void 0!==t){e="{";for(var r in t)t.hasOwnProperty(r)&&(e+=this.createAttribute(r,t[r].data));e+="}"}return e},_traverseTag:function(t){return this.createTagString(t.name,t.data,t.raw,this.traverseTagAttributes(t.attribs),"[]")},_traverseText:function(t){return this.createTextString(this.createData(t.data),t.raw)},_collect:function(t,e){return t.call(this,e)},stampingAST:function(t){for(var e,r,n="",a=0;a<t.length;a++)e=this._whatMethodShouldYouUse(t[a]),e&&(r=this._collect(e,t[a]),void 0!==r&&(n+=r));return n},_moduleMatcher:function(t){return void 0!==this._modules[t.name]?this._modules[t.name].module:!1},_whatMethodShouldYouUse:function(t){return this._isTag(t.type)?this._modules[t.name]?void 0:this._traverseTag:this._isText(t.type)?this._traverseText:void 0},_isTag:function(t){return"tag"===t},_isText:function(t){return"text"===t},_loadModuleFunction:function(t,e,r){var n=t(e,r),a=n.call(this);return a?a:void 0},_generatorFunctionForTags:function(t,e){return t.children=this.actionOnMainArray([],e),t},_traverseModule:function(t,e){var r=this._moduleMatcher(t);return this._loadModuleFunction(r,t,e)}}},function(t,e,r){var n=r(3);t.exports={checkStatementForInners:function(t,e,r){function a(t,e,r){return t?{isVar:t,name:r,value:e}:{isVar:t,value:e}}var i,o=".",s=t.split(o),c=n.inArray(r,t);if(s.length>1){for(var l=0;l<s.length;l++)e.hasOwnProperty(s[l])&&0===l?i=e[s[l]]:i&&i.hasOwnProperty(s[l])&&(i=i[s[l]]);return a(c,i,t)}return c===!0?a(c,e[t],t):a(c,t)}}},function(t,e,r){var n=(r(13),r(15));t.exports={module:function(t,e){function r(t){for(var e=0;e<s.operators.length;e++)t=t.replace(s.operators[e].name,s.operators[e].value);return t}function a(t){for(var e=t.match(/([A-z]+)/g),r=e.length,n=[],a=0;r>a;){var i=e[a++];n.indexOf(i)<0&&n.push(i)}return n}function i(t,e){return Function.apply(null,e.concat("return "+t))}function o(r){var n=State.make();return r?void 0!==t.children&&this.traversingAST(t.children,e).when(function(t){n.keep(t)},function(t){throw new Error(t)}):n.keep(void 0),n.promise}var s={operators:[{name:" lt ",value:"<"},{name:" gt ",value:">"},{name:" le ",value:"<="},{name:" ge ",value:">="}]},c=r(t.attribs.data.trim()),l=a(c),u=i(c,l);return function(){return void 0!==t.children?o.call(this,u.apply(this,n(l,e))):void 0}}}},function(t,e,r){var n=r(14);t.exports=function(t,e){function r(t,e,r){var a=n(r);if(e.length>t+1&&"object"!==a&&"array"!==a&&"length"!==e[t+1])throw new Error("У значения "+e[t]+" нет свойства: "+e[t+1]);return a}console.log(t);for(var a,i=".",o=t.split(i),s=0;s<o.length;s++)0===s?chase=e[o[s]]:chase=chase[o[s]],a=r(s,o,chase);return a}},function(t,e){t.exports=function(t){for(var e=function(t){if(null===t)return"null";if(t&&(1===t.nodeType||9===t.nodeType))return"element";var e=Object.prototype.toString.call(t),r=e.match(/\[object (.*?)\]/)[1].toLowerCase();if("number"===r){if(isNaN(t))return"nan";if(!isFinite(t))return"infinity"}return r},r=["Null","Undefined","Object","Array","String","Number","Boolean","Function","RegExp","Element","NaN","Infinite"],n=function(t){e["is"+t]=function(r){return e(r)===t.toLowerCase()}},a=0;a<r.length;a++)n(r[a]);return e(t)}},function(t,e,r){var n=r(11);t.exports=function(t,e){for(var r,a=[],i=0;i<t.length;i++)e.hasOwnProperty(t[i])&&(r=n.checkStatementForInners(t[i],e,t),r.isVar===!0&&a.push(r.value));return a}},function(t,e,r){var n=(r(13),r(11)),a=r(14),i=r(3),o=r(5);t.exports={module:function(t,e){function r(t){var e=t.split(m.key);return e.length>1?{key:e[0],value:e[1]}:{key:void 0,value:e[0]}}function s(t,e,r,n){return e[n.value]=t[r],n.key&&(e[n.key]=r),e}function c(e,r){for(var n=[],a=0;a<e.length;a++)n.push(this.traversingAST(i.clone(t.children),s(e,r,a,h)));return o.every(n)}function l(e,r){var n=[];for(var a in e)e.hasOwnProperty(a)&&n.push(this.traversingAST(i.clone(t.children),s(e,r,a,h)));return o.every(n)}function u(t){var r,n=t.value,o=i.clone(e),s=d[a(n)];if(void 0===s)throw new Error("Wrong type in for statement arguments");return r=d[a(n)].call(this,n,o),r.when(function(t){return this.actionOnMainArray([],t)}.bind(this),function(t){throw new Error(t)}),r}var h,f,p=t.attribs.data.trim(),d={array:c,object:l},m={splittingKey:" in ",key:" as "},g=p.split(m.splittingKey);if(g.length<2)throw new Error("Wrong arguments in for statement");if(f=n.checkStatementForInners(g[1],e,[g[1]]),!f.value)throw new Error(f.name+" variable is undefined");return h=r(g[0]),function(){return void 0!==t.children?u.call(this,f):void 0}}}},function(t,e,r){r(3);t.exports={module:function(t){function e(){var e=State.make();return this._includeStack[r].when(function(n){n?this.traversingAST(n).when(function(r){t.children=r,e.keep(t)},function(t){throw new Error(t)}):e["break"]('Include tag for "'+r+'" is not found!')}.bind(this),function(t){throw new Error(t)}),e.promise}var r=(t.attribs.data.trim(),t.attribs.template.trim());return function(){return e.call(this)}}}},function(t,e){t.exports=function(t){function e(t){var e="";if(void 0!==t)if(void 0!==t.type)e+=t.value;else for(var r=0;r<t.length;r++)void 0!==t[r].value&&(e+=t[r].value);return e}function r(t){var r="";if(void 0!==t)for(var n in t)t.hasOwnProperty(n)&&(r=" "+n+'="'+e(t[n].data)+'"');return r}function n(t){return"text"===t.type?e(t.data):"<"+t.name+r(t.attribs)+">"+a(t.children)+"</"+t.name+">"}function a(t){var e="";if(void 0!==t)for(var r=0;r<t.length;r++)e+=n(t[r]);return e}var i=a(t);return i}}])});